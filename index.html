<!DOCTYPE html>
<html lang="en">
  <head>
    <link href="https://vjs.zencdn.net/8.16.1/video-js.css" rel="stylesheet" />
  
    <!-- Include Video.js -->
    <script src="https://cdn.jsdelivr.net/npm/video.js@8.16.1/dist/video.min.js"></script>
    <!-- Include Video.js HTTP Streaming (HLS support) -->
    <script src="https://cdn.jsdelivr.net/npm/videojs-http-streaming@2.9.0/dist/videojs-http-streaming.min.js"></script>
  
    <style>
      /* Make the video player fill the viewport */
      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
      }
  
      #my-video {
        width: 100%;
        height: 100%;
        object-fit: cover; /* Scale and fill the viewport */
      }
    </style>
  </head>
  
  <body>
    <video
      id="my-video"
      class="video-js vjs-default-skin"
      controls
      preload="auto"
      poster="MY_VIDEO_POSTER.jpg"
      autoplay
      muted
      data-setup="{}"
    >
      <!-- Fallback sources for MP4/WebM -->
      <source id="m3u8-source" src="" type="application/x-mpegURL" />
      <source src="MY_VIDEO.mp4" type="video/mp4" />
      <source src="MY_VIDEO.webm" type="video/webm" />
      
      <p class="vjs-no-js">
        To view this video please enable JavaScript, and consider upgrading to a
        web browser that
        <a href="https://videojs.com/html5-video-support/" target="_blank">
          supports HTML5 video
        </a>
      </p>
    </video>
  
    <script>
      // Function to get the URL parameter from the query string
      function getURLParameter(name) {
        var url = window.location.href;
        var paramName = name + "=";
        var startIndex = url.indexOf(paramName);
        if (startIndex == -1) return null;
        startIndex += paramName.length;
        var endIndex = url.indexOf("&", startIndex);
        if (endIndex == -1) endIndex = url.length;
        return decodeURIComponent(url.substring(startIndex, endIndex));
      }
  
      // Get the M3U8 URL from the URL parameters
      var m3u8URL = getURLParameter("stream");
  
      // Set the M3U8 URL if provided in the URL parameters
      if (m3u8URL) {
        var m3u8Source = document.getElementById('m3u8-source');
        m3u8Source.src = m3u8URL;
        
        // Initialize Video.js player with HLS support
        var player = videojs('my-video', {
          techOrder: ['html5'], // Prefer HTML5 for video playback
          autoplay: true,       // Enable autoplay
          muted: true,          // Mute the video by default
          sources: [
            {
              type: 'application/x-mpegURL',
              src: m3u8URL // Use the dynamically fetched M3U8 URL
            },
            {
              type: 'video/mp4',
              src: 'MY_VIDEO.mp4' // Replace with your MP4 video URL
            },
            {
              type: 'video/webm',
              src: 'MY_VIDEO.webm' // Replace with your WebM video URL
            }
          ]
        });
      } else {
        alert("No 'stream' URL parameter provided.");
      }
    </script>
  </body>
  
</html>
